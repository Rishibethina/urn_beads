---
title: "Proportion of red beads"
author: Rishith Bethina
format: html
execute: 
  echo: false
---

```{r}
library(tidyverse)
library(tidymodels)
library(broom)
```
Data science often involves analyzing categorical outcomes and their relationships with measurable features. In this study, we use a sample of 50 beads drawn from an urn containing red and white beads to estimate the proportion of red beads in the population.A potential weakness in our model is that if the sample is not truly representative of the urn’s current bead composition, or if unmeasured factors influence bead color, our estimates and inferences may be biased or invalid.Using a sample of 50 beads drawn from the urn, we estimate that approximately 34% are red, with a 95% credible interval ranging from 21% to 47%, reflecting the uncertainty in our estimate.Our estimates might be wrong because the sample may not perfectly represent the entire urn, especially if beads were added or removed after sampling, or if the sampling process was biased. Additionally, factors like measurement errors or assumptions of independence could affect accuracy. Given these uncertainties, a wider confidence interval—such as from 14% to 54%—might better capture the true proportion of red beads, reflecting our cautious skepticism about the data and process.



```{r}
library(dplyr)
library(knitr)

# Assume tidy_fit is your tidy() output
tidy_fit_subset <- tidy_fit %>%
  select(term, estimate, std.error, p.value)

# Create a clean table with 3 decimals
kable(tidy_fit_subset, digits = 3, caption = "Model Coefficients Summary")

```

```{r}
library(ggplot2)

# Generate the base plot
p <- plot_predictions(fit_color, type = "prob", condition = "group")

# Customize with title, subtitle, caption, and axis labels
p + 
  ggtitle("Predicted Probability of Bead Color by Group",
          subtitle = "Size group helps predict the likelihood of beads being red or white") +
  labs(
    caption = "Data source: Urn bead sampling study",
    x = "Bead Size Group",
    y = "Predicted Probability"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(size = 12, color = "gray30"),
    plot.caption = element_text(size = 9, face = "italic"),
    axis.title = element_text(size = 12)
  )

```

```{r}
library(broom)
library(dplyr)

# Fit a model, example:
fit <- glm(color ~ size, data = your_data, family = binomial)

# Tidy the model output
tidy_fit <- tidy(fit)

# Select columns to view
tidy_fit %>% select(term, estimate, std.error, p.value)

```
